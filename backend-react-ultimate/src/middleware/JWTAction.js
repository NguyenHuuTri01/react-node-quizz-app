'use strict';var _0x28f1d1=_0x364e;(function(_0x4703dd,_0x3729ef){var _0x425b7e=_0x364e,_0x997492=_0x4703dd();while(!![]){try{var _0x39a076=parseInt(_0x425b7e(0xd5))/0x1+parseInt(_0x425b7e(0xee))/0x2*(parseInt(_0x425b7e(0xd6))/0x3)+-parseInt(_0x425b7e(0xdb))/0x4*(parseInt(_0x425b7e(0xfc))/0x5)+-parseInt(_0x425b7e(0xdf))/0x6*(-parseInt(_0x425b7e(0x102))/0x7)+-parseInt(_0x425b7e(0xd8))/0x8+-parseInt(_0x425b7e(0x101))/0x9+-parseInt(_0x425b7e(0xff))/0xa*(-parseInt(_0x425b7e(0xf9))/0xb);if(_0x39a076===_0x3729ef)break;else _0x997492['push'](_0x997492['shift']());}catch(_0x4a7279){_0x997492['push'](_0x997492['shift']());}}}(_0x1582,0x39a91));var _jsonwebtoken=_interopRequireDefault(require(_0x28f1d1(0xea))),_lodash=require(_0x28f1d1(0xe4)),_uuid=require(_0x28f1d1(0xe0)),_index=_interopRequireDefault(require(_0x28f1d1(0xfd))),_bcryptjs=_interopRequireDefault(require(_0x28f1d1(0xfb)));function _interopRequireDefault(_0x128984){var _0x528629=_0x28f1d1;return _0x128984&&_0x128984[_0x528629(0xeb)]?_0x128984:{'default':_0x128984};}require(_0x28f1d1(0xd7))[_0x28f1d1(0xef)]();var nonSecurePaths=[_0x28f1d1(0x103),'/login',_0x28f1d1(0xf8),'/refresh-token',_0x28f1d1(0xdd),'/participant/all'],verifyToken=function(_0x4a6d1e){var _0xf72ff=_0x28f1d1,_0x509fc0=process[_0xf72ff(0xf5)][_0xf72ff(0xd2)],_0x128789=null;try{if('HozOd'===_0xf72ff(0xfa)){if(_0x4cbd20 instanceof _0x2ef68a[_0xf72ff(0xda)]['TokenExpiredError'])return'TokenExpiredError';}else _0x128789=_jsonwebtoken['default'][_0xf72ff(0xfe)](_0x4a6d1e,_0x509fc0);}catch(_0x3056c6){if(_0x3056c6 instanceof _jsonwebtoken[_0xf72ff(0xda)][_0xf72ff(0xed)])return _0xf72ff(0xed);}return _0x128789;},extractToken=function(_0x3abd45){var _0x3615b3=_0x28f1d1;return _0x3abd45[_0x3615b3(0xde)][_0x3615b3(0xe5)]&&_0x3615b3(0xf2)===_0x3abd45[_0x3615b3(0xde)][_0x3615b3(0xe5)][_0x3615b3(0xd4)]('\x20')[0x0]?_0x3abd45[_0x3615b3(0xde)]['authorization'][_0x3615b3(0xd4)]('\x20')[0x1]:null;},checkUserJWT=function(_0x17d501,_0x47bcb6,_0x564186){var _0x314c4e=_0x28f1d1;if(nonSecurePaths[_0x314c4e(0xe7)](_0x17d501[_0x314c4e(0xf3)]))return _0x564186();var _0x1f3684=_0x17d501[_0x314c4e(0xf4)],_0xb27e41=extractToken(_0x17d501);return _0x1f3684&&_0x1f3684[_0x314c4e(0xf1)]||_0xb27e41?(_0x1f3684=_0x1f3684&&_0x1f3684['access_token']?_0x1f3684['access_token']:_0xb27e41,(_0xb27e41=verifyToken(_0x1f3684))&&_0x314c4e(0xed)!==_0xb27e41?(_0x17d501[_0x314c4e(0xd3)]=_0xb27e41,void _0x564186()):_0xb27e41&&_0x314c4e(0xed)===_0xb27e41?_0x47bcb6[_0x314c4e(0xd9)](0x195)[_0x314c4e(0xe3)]({'EC':-0x3e7,'DT':'','EM':_0x314c4e(0xdc)}):_0x47bcb6[_0x314c4e(0xd9)](0x191)[_0x314c4e(0xe3)]({'EC':-0x1,'DT':'','EM':_0x314c4e(0xf6)})):_0x47bcb6[_0x314c4e(0xd9)](0x191)[_0x314c4e(0xe3)]({'EC':-0x1,'DT':'','EM':_0x314c4e(0xf6)});},checkUserPermission=function(_0x5d7a04,_0x3ca17a,_0x4b1d66){var _0x127d82=_0x28f1d1;return nonSecurePaths['includes'](_0x5d7a04[_0x127d82(0xf3)])||'/account'===_0x5d7a04['path']?_0x4b1d66():_0x5d7a04[_0x127d82(0xd3)]?(_0x5d7a04[_0x127d82(0xd3)][_0x127d82(0xec)],_0x268e44=_0x5d7a04[_0x127d82(0xd3)][_0x127d82(0xe2)][_0x127d82(0xf7)],_0x1549b8=_0x5d7a04[_0x127d82(0xf3)],!_0x268e44||0x0===_0x268e44['length']||!0x0!==_0x268e44[_0x127d82(0xe6)](function(_0x4a1bb5){var _0x5e4d43=_0x127d82;if(_0x5e4d43(0xe8)!==_0x5e4d43(0x100))return _0x4a1bb5[_0x5e4d43(0xf0)]===_0x1549b8||_0x1549b8[_0x5e4d43(0xe7)](_0x4a1bb5['url']);else _0x5788d5();})?_0x3ca17a[_0x127d82(0xd9)](0x193)['json']({'EC':-0x1,'DT':'','EM':'you\x20don\x27t\x20permission\x20to\x20access\x20this\x20resource...'}):void _0x4b1d66()):_0x3ca17a[_0x127d82(0xd9)](0x191)[_0x127d82(0xe3)]({'EC':-0x1,'DT':'','EM':_0x127d82(0xf6)});var _0x268e44,_0x1549b8;},addDelay=function(_0x28f6e1,_0x3e7deb,_0x2628f2){var _0x14dc24=_0x28f1d1,_0x42217c;null!=_0x28f6e1&&null!=(_0x42217c=_0x28f6e1['body'])&&_0x42217c[_0x14dc24(0xe9)]&&+(null==_0x28f6e1||null==(_0x42217c=_0x28f6e1[_0x14dc24(0xe1)])?void 0x0:_0x42217c[_0x14dc24(0xe9)])?setTimeout(function(){_0x2628f2();},+_0x28f6e1['body'][_0x14dc24(0xe9)]):_0x2628f2();};function _0x364e(_0x5f0642,_0x430ed4){var _0x15822b=_0x1582();return _0x364e=function(_0x364e6a,_0x108bdb){_0x364e6a=_0x364e6a-0xd2;var _0x64b472=_0x15822b[_0x364e6a];return _0x64b472;},_0x364e(_0x5f0642,_0x430ed4);}function _0x1582(){var _0x4472bc=['body','groupWithRoles','json','lodash','authorization','some','includes','hjPxi','delay','jsonwebtoken','__esModule','email','TokenExpiredError','304266SMbHom','config','url','access_token','Bearer','path','cookies','env','[Not\x20authenticated\x20the\x20user]\x20JWT\x20Token\x20đã\x20hết\x20hạn,\x20hoặc\x20bạn\x20không\x20truyền\x20lên\x20Bearer\x20Token\x20ở\x20header\x20request.\x20Vui\x20lòng\x20login,\x20hoặc\x20kiểm\x20tra\x20header\x20request\x20đã\x20truyền\x20JWT\x20chưa\x20?','Roles','/register','70521WVDvdT','RylOw','bcryptjs','5HxgbNw','../models/index','verify','110NYoVhr','QMmUZ','3817458qcELHO','3647MGDjCC','/logout','JWT_SECRET','user','split','415967KCEsGa','9esqMex','dotenv','2471664Rjiqsv','status','default','1722028FuCzyb','JWT\x20Token\x20đã\x20hết\x20hạn.\x20Bạn\x20cần\x20dùng\x20Refresh_Token\x20để\x20lấy\x20token\x20mới,\x20or\x20Login\x20lại\x20và\x20sử\x20dụng\x20Access_Token\x20mới\x20:v','/participant','headers','5262NUkMUk','uuid'];_0x1582=function(){return _0x4472bc;};return _0x1582();}module['exports']={'checkUserJWT':checkUserJWT,'checkUserPermission':checkUserPermission,'addDelay':addDelay};